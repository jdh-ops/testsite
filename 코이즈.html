<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µí•© ë°ì´í„° ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° ë ˆì´ì•„ì›ƒ */
        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; background-color: #f4f7f9; color: #333; }
        .container { max-width: 100%; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { text-align: center; margin-bottom: 25px; color: #2c3e50; }

        /* ìƒë‹¨ ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 20px; background: #fff; padding: 15px; border: 1px solid #e1e4e8; border-radius: 8px; gap: 15px; }
        .search-group { flex: 1; display: flex; flex-direction: column; gap: 5px; }
        input[type="text"] { padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        select { padding: 9px; border: 1px solid #ddd; border-radius: 4px; background: #fff; cursor: pointer; }
        button { padding: 10px 20px; background: #5c6bc0; color: white; border: none; border-radius: 4px; cursor: pointer; transition: 0.2s; }
        button:hover { background: #3f51b5; }

        /* í…Œì´ë¸” ë ˆì´ì•„ì›ƒ ë° ë“œë˜ê·¸ ê´€ë ¨ */
        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #dee2e6; background: #fff; }
        th, td { border: 1px solid #dee2e6; padding: 12px; text-align: left; position: relative; overflow: hidden; text-overflow: ellipsis; }
        th { background-color: #f8f9fa; font-weight: bold; user-select: none; }
        
        /* ì»¬ëŸ¼ ë„ˆë¹„ ì¡°ì ˆ í•¸ë“¤(Resizer) */
        .resizer {
            position: absolute; right: 0; top: 0; width: 6px; height: 100%;
            cursor: col-resize; z-index: 10;
        }
        .resizer:hover { background-color: #5c6bc0; }

        /* íŠ¹ìˆ˜ ì»¬ëŸ¼ ìŠ¤íƒ€ì¼ */
        .sort-icon { cursor: pointer; color: #5c6bc0; margin-left: 5px; font-size: 12px; }
        .url-cell { font-size: 13px; word-break: break-all; white-space: normal; line-height: 1.4; }
        .url-cell a { color: #1a73e8; text-decoration: none; }
        .url-cell a:hover { text-decoration: underline; }
        tr:hover { background-color: #f1f3f9; }
        #status { font-size: 13px; color: #666; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“‹ ë°ì´í„° ë°ì´í„°ë² ì´ìŠ¤ í†µí•© ì¡°íšŒ</h1>

    <div class="control-panel">
        <div class="search-group">
            <label for="searchInput">í†µí•© ê²€ìƒ‰</label>
            <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">
        </div>
        <div class="search-group" style="max-width: 200px;">
            <label for="platformFilter">í”Œë«í¼ í•„í„°</label>
            <select id="platformFilter" onchange="applyFilters()">
                <option value="">ì „ì²´ ë³´ê¸°</option>
            </select>
        </div>
        <button onclick="resetAll()">í•„í„° ì´ˆê¸°í™”</button>
        <div id="status">ì—°ê²° ì¤‘...</div>
    </div>

    <div class="table-wrapper">
        <table id="mainTable">
            <thead>
                <tr>
                    <th style="width: 140px;">ì „ë‹¬ë‚ ì§œ <span class="sort-icon" onclick="toggleSort()">â†• ì •ë ¬</span><div class="resizer"></div></th>
                    <th style="width: 120px;">í”Œë«í¼<div class="resizer"></div></th>
                    <th style="width: 350px;">URL (ì›ë¬¸)<div class="resizer"></div></th>
                    <th style="width: 100px;">ê²€í† ì™„ë£Œ<div class="resizer"></div></th>
                    <th style="width: 200px;">íŠ¹ì´ì‚¬í•­<div class="resizer"></div></th>
                    <th style="width: 150px;">ë¹„ê³ <div class="resizer"></div></th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTIepAzwHme1ArBFfogzbBZiqqx0Fmz-8qpt3teRp3kLWhp3m8Frdj5-UgYy0fwtqoebtFmfIcZAfs2/pub?gid=0&single=true&output=csv';
    
    let allData = [];
    let isAsc = true;

    // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadData() {
        const status = document.getElementById('status');
        try {
            const response = await fetch(CSV_URL);
            const text = await response.text();
            allData = parseCSV(text);
            
            updatePlatformDropdown();
            renderTable(allData);
            initResizers(); // ë“œë˜ê·¸ ê¸°ëŠ¥ í™œì„±í™”
            status.innerText = `ì´ ${allData.length}ê±´ ë¡œë“œ ì™„ë£Œ`;
        } catch (e) {
            status.innerText = "âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨";
        }
    }

    // CSV íŒŒì‹±
    function parseCSV(text) {
        const lines = text.split(/\r?\n/);
        const headers = lines[0].split(',').map(h => h.trim());
        return lines.slice(1).filter(l => l.trim()).map(line => {
            const values = line.split(',');
            let obj = {};
            headers.forEach((h, i) => obj[h] = values[i] ? values[i].trim() : "");
            return obj;
        });
    }

    // í”Œë«í¼ í•„í„° ëª©ë¡ ìƒì„±
    function updatePlatformDropdown() {
        const select = document.getElementById('platformFilter');
        const platforms = [...new Set(allData.map(d => d['í”Œë«í¼']))].filter(p => p).sort();
        platforms.forEach(p => {
            const opt = document.createElement('option');
            opt.value = p; opt.innerText = p;
            select.appendChild(opt);
        });
    }

    // ë‚ ì§œ ì •ë ¬ ê¸°ëŠ¥ (1ë²ˆ ìš”ì²­)
    function toggleSort() {
        isAsc = !isAsc;
        allData.sort((a, b) => {
            const d1 = new Date(a['ì „ë‹¬ë‚ ì§œ']);
            const d2 = new Date(b['ì „ë‹¬ë‚ ì§œ']);
            return isAsc ? d1 - d2 : d2 - d1;
        });
        applyFilters();
    }

    // í•„í„°ë§ ë° ê²€ìƒ‰ í†µí•© (1ë²ˆ ìš”ì²­)
    function applyFilters() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const platform = document.getElementById('platformFilter').value;

        const filtered = allData.filter(row => {
            const matchSearch = Object.values(row).some(v => String(v).toLowerCase().includes(term));
            const matchPlatform = !platform || row['í”Œë«í¼'] === platform;
            return matchSearch && matchPlatform;
        });
        renderTable(filtered);
    }

    // í…Œì´ë¸” ë Œë”ë§ (3ë²ˆ ìš”ì²­: URL ì›ë¬¸)
    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = data.map(row => `
            <tr>
                <td>${row['ì „ë‹¬ë‚ ì§œ']}</td>
                <td>${row['í”Œë«í¼']}</td>
                <td class="url-cell"><a href="${row['URL']}" target="_blank">${row['URL']}</a></td>
                <td>${row['ê²€í† ì™„ë£Œ']}</td>
                <td>${row['íŠ¹ì´ì‚¬í•­']}</td>
                <td>${row['ë¹„ê³ ']}</td>
            </tr>
        `).join('');
    }

    // ì»¬ëŸ¼ ë“œë˜ê·¸ ë„ˆë¹„ ì¡°ì ˆ ê¸°ëŠ¥ (2ë²ˆ ìš”ì²­)
    function initResizers() {
        const table = document.getElementById('mainTable');
        const headerCols = table.querySelectorAll('th');
        headerCols.forEach(col => {
            const resizer = col.querySelector('.resizer');
            if (!resizer) return;

            resizer.addEventListener('mousedown', (e) => {
                const startX = e.clientX;
                const startWidth = col.offsetWidth;

                const onMouseMove = (e) => {
                    const width = startWidth + (e.clientX - startX);
                    col.style.width = width + 'px';
                };

                const onMouseUp = () => {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                };

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
        });
    }

    function resetAll() {
        document.getElementById('searchInput').value = '';
        document.getElementById('platformFilter').value = '';
        renderTable(allData);
    }

    document.getElementById('searchInput').addEventListener('input', applyFilters);
    loadData();
</script>

</body>
</html>

