<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì—‘ì…€ ë°ì´í„° ì‹¤ì‹œê°„ ì¡°íšŒ</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }
        .search-box { margin-bottom: 20px; display: flex; gap: 10px; }
        input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; border-radius: 4px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f8f9fa; }
        tr:hover { background-color: #f1f1f1; }
        .status { margin-bottom: 10px; color: #666; font-size: 0.9em; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“‹ ë°ì´í„° ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ</h1>
    
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (í”Œë«í¼, íŠ¹ì´ì‚¬í•­ ë“±)">
        <button id="searchButton">ê²€ìƒ‰í•˜ê¸°</button>
    </div>
    
    <div id="status" class="status">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

    <table>
        <thead>
            <tr>
                <th>ì „ë‹¬ë‚ ì§œ</th>
                <th>í”Œë«í¼</th>
                <th>URL</th>
                <th>ê²€í† ì™„ë£Œ</th>
                <th>íŠ¹ì´ì‚¬í•­</th>
                <th>ë¹„ê³ </th>
            </tr>
        </thead>
        <tbody id="tableBody">
            </tbody>
    </table>
</div>

<script>
    // 1. ë³¸ì¸ì˜ êµ¬ê¸€ ì‹œíŠ¸ CSV ì£¼ì†Œ
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTIepAzwHme1ArBFfogzbBZiqqx0Fmz-8qpt3teRp3kLWhp3m8Frdj5-UgYy0fwtqoebtFmfIcZAfs2/pub?gid=0&single=true&output=csv';
    
    let allData = [];

    // 2. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
    async function fetchSheetData() {
        const statusDiv = document.getElementById('status');
        try {
            const response = await fetch(CSV_URL);
            if (!response.ok) throw new Error('ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ ì˜¤ë¥˜');
            const data = await response.text();
            
            allData = parseCSV(data);
            renderTable(allData); // ì—¬ê¸°ì„œ í•¨ìˆ˜ í˜¸ì¶œ
            statusDiv.innerText = `ì´ ${allData.length}ê°œì˜ ë°ì´í„°ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.`;
        } catch (error) {
            console.error('ë¡œë“œ ì‹¤íŒ¨:', error);
            statusDiv.innerText = 'âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ê²Œì‹œ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.';
        }
    }

    // 3. CSV íŒŒì‹± í•¨ìˆ˜
    function parseCSV(csvText) {
        const lines = csvText.trim().split(/\r?\n/);
        const headers = lines[0].split(',').map(h => h.trim());
        return lines.slice(1).map(line => {
            const values = line.split(',');
            const obj = {};
            headers.forEach((header, index) => {
                obj[header] = values[index] ? values[index].trim() : '';
            });
            return obj;
        });
    }

    // 4. í…Œì´ë¸” ê·¸ë¦¬ê¸° í•¨ìˆ˜ (ì¤‘ìš”: ì´ ë¶€ë¶„ì´ ë¹ ì ¸ìˆì–´ì„œ ì—ëŸ¬ê°€ ë‚¬ë˜ ê²ƒì…ë‹ˆë‹¤)
    function renderTable(dataArray) {
        const tableBody = document.getElementById('tableBody');
        tableBody.innerHTML = '';

        if (dataArray.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="6" style="text-align:center;">ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            return;
        }

        dataArray.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item['ì „ë‹¬ë‚ ì§œ'] || ''}</td>
                <td>${item['í”Œë«í¼'] || ''}</td>
                <td><a href="${item['URL']}" target="_blank">${item['URL'] ? 'ë§í¬' : ''}</a></td>
                <td>${item['ê²€í† ì™„ë£Œ'] || ''}</td>
                <td>${item['íŠ¹ì´ì‚¬í•­'] || ''}</td>
                <td>${item['ë¹„ê³ '] || ''}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    // 5. ê²€ìƒ‰ ê¸°ëŠ¥
    function filterData() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const filtered = allData.filter(row => 
            Object.values(row).some(val => String(val).toLowerCase().includes(searchTerm))
        );
        renderTable(filtered);
    }

    // ë²„íŠ¼ í´ë¦­ ë° ì—”í„°í‚¤ ì´ë²¤íŠ¸ ì—°ê²°
    document.getElementById('searchButton').addEventListener('click', filterData);
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') filterData();
    });

    // ì‹¤í–‰
    fetchSheetData();
</script>

</body>
</html>
